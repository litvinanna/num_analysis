\section{Сплайны}



На прошлых лекциях мы рассматривали задачи приближения функции $f:I \rightarrow\mathbb{R}$ полиномами, то есть элементами линейного пространства $P_n$ размерности $n$. Чтобы распространить другие методы приближения, прежде всего надо ввести некоторое новое конечномерное векторное пространство заменяющее $P_n$. Такой заменой может служить \textbf{ пространство} $S_{n,v}(X,I)$ \textbf{сплайнов} степени $n\geq 1$, дефекта $v\geq 1$ $(v\leq n)$, построенное по разбиению $X = (x_0=a < x_1 < x_2\ldots < x_N=b)$. 

По определению функция $s:I\rightarrow \mathbb{R}$ принадлежит пространству $S_{n,v}(X,I)$, если выполняются следующие два условия:
\begin{enumerate}
	\item На каждом интервале $(x_i,x_{i+1})$, $s(x)$ это полином степени $n$
	\item На всем интервале $I=[a,b]$ функция $s(x)$ имеет $n-v$ непрерывных производных
\end{enumerate}
Таким образом сплайн это функция "склеенная" из полиномов так, чтобы во внутренних точках $x_i,$ $ i = 1\ldots N-1$ выполняются условия "склейки":
\begin{equation}
s^{\left( k\right) }\left( x_{i}-0\right) =s^{\left( k\right) }\left( x_{i}+0\right),
\begin{aligned}k=0,1\ldots n-v\\ i=1\ldots N-1\end{aligned}
\end{equation}
Здесь через $\varphi(s_i\pm 0)$ обозначаются пределы $\varphi(x)$ при $x \rightarrow x_i$ справа и слева от точки $x_i$ производная порядка $n-v+1$ уже может иметь разрывы в точках ???.

Ясно, что $S_{n,v}(X,I)$ - линейное пространство и его размерность:
\begin{equation}
dim S_{n,v}(X,I) = v(N-1) +n+1
\end{equation}
Докажем эту формулу. У нее имеется $N$ интервалов и в каждом из них свой полином порядка $n$, который зависит от $n+1$ параметра (коэффициентов полинома). Таким образом:
\begin{equation}
\textit{число параметров} = N(n+1)
\end{equation} 
С другой стороны, в каждой из $N-1$ внутренних точек должны быть непрерывны производные порядка $0,1\ldots n-v$ и следовательно:
\begin{equation}
\textit{число условий} = (N-1)(n-v+1)
\end{equation}
Таким образом:
\begin{equation}
\begin{aligned}dim S_{n,v}(X,I) = \textit{число параметров - число условий} =\\
 N(n+1)-(N-1)(n-v+1)=v(N-1)+n+1\end{aligned}
\end{equation}
Наиболее часто используются сплайны дефекта $1$ и
\begin{equation}
dim  S_{n,1}(X,I) = N+n
\end{equation}
В пакетах прикладных программ встречаются такие понятия как \textbf{B-сплайны} и \textbf{фундаментальные сплайны}. Под B-сплайнами понимаются сплайны деффекта 1 с выбором специального базиса $B_n^j(x)$ $j=-n,-n+1,\ldots N-1$ в пространстве $S_{n,1}(X,I)$. Сплайны $B_n^j(x)$ локальны, т.е.  $B_n^j(x)\neq 0$ только если $x\in(x_i,x_i+n+1)$. При этом предпологается, что к разбиению $X$ добавлены точки $x_{-n}<x_{-n+1}<\ldots<a$ и $b<x_{N+1}<x_{N+2}<\ldots<x_{N+n}$ мы не будем давать опрделение сплайнам $B_n^j(x)$, хотя они иногда применяются для сглаживания ЭД.

Фундаментальные сплайны используются в задачах интерполяции. Эти сплайны не принадлежат пространству $S_{n,1}(X,I)$,  они принадлежат пространству $S_{n,1}(\Delta,I)$, где:
\begin{equation}
\begin{aligned}\Delta=(\varepsilon_1\ldots\varepsilon_{N-n}), \\
x_i<\varepsilon_i<x_{i+n}\end{aligned}
\end{equation}
Выбор точек $\varepsilon_1\ldots\varepsilon_{N-n}$ зависит от рассматриваемой задачи и:
\begin{equation}
dim  S_{n,1}(\Delta,I) = N+1
\end{equation}
В пространстве $S_{n,1}(\Delta,I)$ существует базис $e^i(x)$ такой , что:
\begin{equation}
e^i(x_k)=\delta_{ik},\;\; 	i=0\ldots N
\end{equation}
Знание базиса $e^i(x)$ позволяет решить задачу интерполяции функции $f(x)$. Если известны величины $f(x_k)$ это решение имеет вид:
\begin{equation}
s\left( x\right) =\sum ^{N}_{i=0}e^{i}\left( x\right) f\left( x_{i}\right)
\end{equation}
Так как из (9) следует, что:
\begin{equation}
s\left( x_k\right) =f\left( x_{k}\right),\ \  k=0\ldots N
\end{equation}

Сплайны бывают \textbf{интерполяционными} и \textbf{сглаживающими}. Сплайн называется \textbf{интерполяционными}, если выполнены условия (11).

Наибольший интерес представляют интерполяционные сплайны из $S_{3,1}(X,I)$ - \textbf{кубические сплайны деффекта 1}. Число условий (11) равно $N+1$, в то время как:
\begin{equation}
dim  S_{3,1}(X,I) = N+3
\end{equation}
Таким образом для определения интерполяционного сплайна $s(x)$ надо задать еще два условия. Наиболее часто используются условия:
\begin{equation}
s^{( 1) }(a) =\dfrac{f\left( x_{1}\right) -f\left( x_{0}\right) }{x_{1}-x_{0}},s^{\left( 1\right) }\left( b\right) =\dfrac{\left( x_{N}\right)-f( x_{N}-1)}{x_{N}-x_{N-1}}
\end{equation}
или условия:
\begin{equation}
s^{(2) }(a) =s^{(2) }(b) 
\end{equation}
Пусть такие условия заданы, тогда для определения сплайна $s(x)$ имеется(cм (4)) $3(N-1)+N+1+2=4N$ условий для поределения $4N$ коэффициентов $a^i_0,a^i_1,a^i_2,a^i_3$ определяющих полином третьего порядка в интервале $(x_i;x_{i+1}), \ (i=0,1\ldots N-1)$, т.е. надо решить систему из $4N$ линейных уравнений. 


Кроме упомянутых выше сплайнов в пакетах прикладных программ встречаются \textbf{Эрмитовы сплайны}. Это элементы пространства $S_{3,2}(X,I)$, и:
\begin{equation}
dim  S_{3,2}(X,I) = 2(N+1)
\end{equation}
Если известны величины $f(x_i),f^{(1)}(x_i)$, то существует Эрмитов сплайн $s(x)$ такой, что:
\begin{equation}
s(x_i)=f(x_i), \ s^{(1)}(x_i)=f^{(1)}(x_i)
\end{equation}

В Лекции \ref{lecture:2} были отмечены трудности, возникающие при использовании интерполяционных полиномов высокого порядка. К этим трудностям добавляется ещё и неустойчивость полинома Лагранжа относительно малых вариаций величин $f(x_i)$.
Сплайны лишены этих недотатков. Пусть $f\in W^k(M_k,I)$ и рассмотрим точность интерполяции функции $f$ с помощью кубического сплайна деффекта 1. Тогда:
\begin{equation}
\parallel s-f\parallel ?? \leq C_k h^k M_k
\end{equation}
и в этой формуле $k=max(x_{i+1}-x_i)$,
\begin{equation}
C_{2}=\dfrac{13}{48},C_{3}=\dfrac{41}{564},C_{4}=\dfrac{5}{364}
\end{equation}
и никаких трудностей типа быстрого роста $\lambda_n(f,X)$ (2.22) c ростом $n$ (2.25) - не возникает.

Английское слово "spline" означает гибкую, упругую ленту. Сплайны, сами того не зная, использовали английские корабелы. На следующем рисунке сплошной линией показана правая часть поперечнго разреза парусника. 

===========
вставить график
===========

Исходными данными служили точки $\ast$. Требовалось провести через эти точки гладкую кривую. Упругая лента укладывалась так, чтобы она проходила через точки $\ast$. Это и рассматривалось как чертеж попереченого сечения будующего корабля. Оказывается, что полученная кривая $n=f(x)$ это $f(x)=s(x)$, где $s(x)$ интерполяционный сплайн из $S_{3,1}(X,I)$ с дополнительными условиями (14).
С математической точки зрения это означает, что $f(x)=s(x)$ это решение следующей задачи: Найти функцию $f(x)$, которая дает минимум величины:
\begin{equation}
J[f]=\int_a^b[f^{(2)}(x)]^2dx
\end{equation}
при условии $f(x_i)=f_i$ ($f_i$ - заданы).
Вместо $J[f]$ можно рассмотреть величину:
\begin{equation}
J[ f| S_{0},S_1\ldots S_{N}] = J \left[ f\right] + \sum ^{N}_{i=0}\rho^{-1}_{i}\left[ f\left( x_{i}\right) -f_{i}\right] ^{2}
\end{equation}
где $\rho_i$ - заданы. Минимум этой велчины - это снова $f(x)=s(x), \ s\in S_{3,1}(X,I)$, 
но теперь уже условия $s(x_i)=f_i$ не выполняются и решение называется сглаживающим сплайном. Величины $s_i$ выбираются из условия $s_i\approx \varepsilon$, где $\varepsilon$ - величина ошибки, с которой известны величины $f(x_i)$.
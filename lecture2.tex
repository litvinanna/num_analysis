\section{Лекция 2. Приближение функции полиномами}
В первой лекции было отмечено, что для описания зависимостей полезно иметь систему функций $\varphi _i(x)$ такую, что их значения легко вычисляются и любую непрерывную функцию $f: I \rightarrow \mathbb{R} $ заданную на интервале $ I = [a,b] $ можно с заданной точностью приблизить функциями вида 
\begin{equation}
\varPsi_n(x)=\sum_{i=0}^{n-1}{a_i\varphi_i(x)} \qquad i = 1, 2, 3, ...
\end{equation}

В качестве $\{\varphi_i(x)\}$ можно выбирать различные системы функций, но наиболее важен с практической точки зрения случай 


\begin{equation}
\varphi _i(x) = x^i \qquad i = 0, 1, 2, ...
\end{equation}

Тогда
\begin{equation}\label{eq:polynom}
\varPsi _n(x) = p_n(x) = a_0 + a_1x + a_{n-1}x^{n-1} 
\end{equation}


Полиномы $p_n(x)$ образуют n-мерное \textbf{линейное пространство $\mathscr{P}_n$}, и ниже речь идет о приближении функций  $f:I \rightarrow \mathbb{R} $ полиномами $p_n(x) \in \mathscr{P}_n $. Подчеркнем, что максимальная степень полинома из пространства  $\mathscr{P}_n$ равна $n - 1$.


Определение точности приближения требует введения понятия нормы $\parallel f \parallel$ функции $f$. 
Функции $f: I \rightarrow \mathbb{R} $ образуют линейное пространство $V[f]$, размерность которого бесконечна. Это означает, что существует функции $e_i(x) \; i = 1, 2, 3 ...$ такие, что любая функция $f \in V[f]$ может быть единственным образом представлена в виде бесконечного ряда 
\begin{equation}
f(x) = \sum_{i=0}^{\infty} {c_i e_i(x)}
\end{equation}
В этом случае говорят, что $\{e_i(x)\}$ \textbf{базис} в пространстве $V[f]$.

\textbf{Нормой} в любом векторном пространстве $V$ называется любая функция 
 
\begin{equation}
\parallel \; \parallel \; : V \rightarrow \mathbb{R}^+
\end{equation}
такая что, если $X\in V$, то

\begin{equation}
\begin{array}{l}
\parallel X \parallel \; \geq 0 \; \text{и}  \parallel X \parallel \; = 0 \Rightarrow X = 0 \\
\parallel \alpha X \parallel \; = \alpha \parallel X \parallel  \\ 
\parallel \alpha X + \beta Y\parallel \; \leq \; \parallel \alpha  X \parallel + \parallel \beta Y \parallel \text{(неравенство треугольника)}
\end{array}
\end{equation}

Если $V = \mathbb{R}^n$ (n-мерное вектроное пространство) и $X = (x_1 .. x_n)$, то обычная эвклидова норма $\parallel\;\parallel_2$ (длина вектора $X$) задается равенством
\begin{equation}
\parallel X\parallel_2 \; = \left[\sum_{i=1}^{n} x_i^2 \right]^{1/2}.
\end{equation}

Но в $\mathbb{R}^n$ существуют и другие нормы, например,

\begin{equation}
\begin{gathered}
\parallel X \parallel_1 \; = \sum_{i = 1}^{n}|x_i| \\
\parallel X \parallel_c \; = \max_{i = 1...n}|x_i|
\end{gathered}
\end{equation}

Эти формулы прямо приводят к определению нормы в пространстве функции $f: I \rightarrow \mathbb{R}$ и по определению

\begin{equation}
\begin{gathered}
\parallel f \parallel_2 \; = \left[ \int_{a}^{b} f^2(x)dx \right]^{1/2} \quad \text{($L^2$-норма)}\\
\parallel f \parallel_1 \; = \int_{a}^{b} |f(x)|dx \quad \text{($L^1$-норма)} \\
\parallel f \parallel_c \; = \max_{x \in I}|f(x)| \quad \text{(равномерная норма)}
\end{gathered}
\end{equation} 

С точки зрения приложений наибольший интерес представляет равномерная норма $\parallel \; \parallel_c	$ и точность приближения функции $f$ полиномом $p_n$ задается числом 
\begin{equation}
\parallel f - p_n \parallel_c \; = \max_{x\in [a, b]} |f(x)-p_n(x)|
\end{equation}


Теорема Вейерштрасса утверждает, что любую непрерывную функцию $f: I \rightarrow \mathbb{R}$  с любой заданной точностью $\varepsilon$ можно приблизить полиномом $p_n(x)$ $(n = n(\varepsilon))$. 
Эта теорема говорит только о существовании такого полинома $p_n$, но ничего не говорит о том, как его построить и какова завиимость $n$ от $\varepsilon$. 
Из теоремы Вейерштрасса следует, что $\{x^i\} \; (i = 0, 1, 2, ...)$ базис в пространстве $V[f]$ непрерывных функций $f$ на интервале $I$.

Гораздо интереснее следующая постановка задачи: с какой точностью заданная функция $f$ может быть приближена полиномом заданной степени. 
Оказывается, что среди полиномов степени $n - 1$ существует единственный \textbf{полином $p_n[f]$ наилучшeго приближения}. Если

\begin{equation}\label{eq:best_polynom}
\parallel f - p_n(f) \parallel_c \; = \varepsilon_n[f],
\end{equation}

то для любого полинома $p$ степени $\leq n - 1$

\begin{equation}
\parallel f - p \parallel_c \; > \varepsilon_n[f],
\end{equation}

Это тоже теорема существования, в которой ничего не говорится о том, как найти $p_n(f)$ и  $\varepsilon_n[f]$.

Построение системы полиномов $p_n(f)$ для заданной функции $f$ -- очень трудная задача, точное решение которой при всех $n$ известно только для некоторых функций $f$. 
Однако существует алгоритм посторения $p_n(f)$ для заданного n (например, алгоритм Ремеза).

Важно то, что для величины $\varepsilon_n(f)$ существуют хорошие оценки сверху и для этого не надо точно знать функцию $f$ и достаточно предположиить, что $f \in W^k(M_k, I)$. Это означает, что функция $f$ на интервале $I$ имеет $k$ непрерывных производных и $|f^{(k)}(x)|\leq M_k$. 

Таким образом,

\begin{eqnarray}
W^k[M_k, I] = \{f: I \rightarrow \quad , \text{ -- производные} \nonumber \\
f^{(i)}(x) \text{ непрерывны при $i \leq k$ и } |f^{(k)}(x)| \leq M_k \}
\end{eqnarray}


\textbf{Класс функций $W^k[M_k, I]$} удобен для характеристики точности приближений, так как для любой функции $f \in W^k[M_k, I]$ имеет место достаточно точная оценка

\begin{equation}
\varepsilon_n[f] \leq \left(\frac{b-a}{2}\right)^k \frac{A_k M_k}{n^k},\; A_k = \left(\frac{\pi k}{2}\right) ^k \frac{1}{k!}
\end{equation}

При $k \geq 2$ с помощью формулы Стирлинга получим, что 

\begin{equation}
\varepsilon_n[f] \leq \left(\frac{(b-a)4,3}{n}\right)^k M_k \quad \forall f \in W^k[M_k, I].
\end{equation}

Эта формула позволяет оценить, с какой точностью функция $f \in W^k[M_k, I]$ может быть приближена полиномами степени $\leq n-1$, но мы по-прежнему не имеем метода построения приближений.
Такой метод дает \textbf{интерполяция}.

Рассмотрим \textbf{разбиение} $X = (x_1, x_2,..., x_n)$ интервала $I = [a, b]$. Это означает просто, что заданы $n$ различных точек $x_i \in I, \; i = 1 ... n$ и $x_i \neq x_j$ и не предполагается, что $x_{i+1} > x_i$.

\textbf{Интерполяционный полином} $\pi(f|x) \in \mathscr{P}_n $ зависит от $n$-параметров -- коэффициентов $a_0, a_1 .. a_{n-1}$ \ref{eq:polynom}, которые определяются из условий

\begin{equation}\label{eq:interpolation}
\pi(f|x)(x_j) = f(x_j) \quad j = 1 .. n
\end{equation}

Это $n$ условий для определения $n$ коэффициентов  $a_0, a_1 .. a_{n-1}$ полинома

\begin{equation}
\pi(f|x)(x) = a_0 + a_1x + a_{n-1}x^{x-1}.
\end{equation}
Отсюда следует, что существует только один такой полином и этот полином можно выписать явно. 

Действительно, пусть известны полиномы $e^i(x_i) \in \mathscr{P}_n $, такие что

\begin{equation}
e^i(x_i)= \delta_{ij} =
\begin{cases}
1, i = j \\
0, i \neq j

\end{cases}
\end{equation}

Тогда 
\begin{equation}
\pi_n(f|x)(x) = \sum_{i = 1}^{n} f(x_i)e^i(x).
\end{equation}

Условие интерполяции \ref{eq:interpolation} выполнено так как 

\begin{equation}
\pi_n(f|x)(x_j) = \sum_{i = 1}^{n} f(x_i)\delta_{ij} = f(x_j).
\end{equation}

Легко догадаться, какой вид имеет полином $e^i(x)$. Он задается равенством 

\begin{equation}
\varepsilon^i(x) = \frac{(x-x_1)(x-x_2)..(x-x_{i-1})(x-x_{i+1}) ...(x-x_n)}{(x_i-x_1)(x_i-x_2)..(x_i-x_{i-1})(x_i-x_{i+1})..(x_i - x_n )}
\end{equation}

Мы построили \textbf{интерполяционный полином в форме Лагранжа}. 

Рассмотрим точность интерполяции. Она задается формулой 

\begin{equation}
\parallel f - \pi_n| e(x) \parallel_c \; \leq (1+ \lambda_n(f, x))\varepsilon_n(f)
\end{equation}

и во всяком случае 

\begin{equation}
\lambda_n(f, x) \geq \frac{e_n n}{8 \sqrt{\pi}} \quad (n \geq 2)
\end{equation}

Величина $\lambda_n(f, x)$ показывает насколько интерполяционный полином проигрывает полиному наилучшего приближения $p_n(f)$ \ref{eq:best_polynom}.


Эти величины сильно зависят от выбора разбиения $X$ и в случае \textbf{равномерного разбиения} для которого

\begin{equation}
x_i = a + \frac{b-a}{n-1}(i-1) \quad i = 1...n
\end{equation}

величина $\lambda_n(f, x)$ быстро растет с ростом $n$ и


\begin{equation}
\frac{2^{n-3}}{n^{3/2}} \leq \lambda_n(f, x) \leq 2^n
\end{equation} 


Таким образом, если  $f \in W^k[M_k, I]$, то ошибка интерполяции по равномерной сетке растет как $2^kn^{-k}$.

В 1901 году немецкий физик Рунге пытался интерполировать на интервале $[-1; 1]$ функцию

\begin{equation}
f(x) = \frac{1}{1+25x^2}
\end{equation}

Используя полином 20-ой степени он обнаружил, что при равномерном разбиении ошибка интерполяции катастрофически растет в окрестности точек $x = \pm 1$ и между точками $x = 0,9$ и $1$ она имеет порядок $10^2$.

Этот пример показывает, что использовать интерполяционные полиномы высокого порядка надо с большой осторожностью. Однако их можно использовать, если перейти к неравномерному разбиению, в котором шаг разбиения уменьшается при приближении к концу интервала.
Нужное разбиение задается формулой 

\begin{equation}\label{eq:27}
x_m = \frac{b+a}{2} + \frac{b-a}{2} \cos \frac{\pi(2m-1)}{2n} \quad m = 1...n
\end{equation}

И если $X = \{x_m\}$ и $f \in W^k[M_k, I]$ то 

\begin{equation}
\parallel \pi_n (f(x) -f) \parallel_c \; \leq \left(
9+ \frac{4}{\pi}\mathrm{ln} (n)\right) \left( \frac{b-a}{2}\right)^k \frac{M_kA_k}{n^k}
\end{equation}

Разбиение \ref{eq:27} называется Чебышевским, так как $\cos \frac{\pi(2m-1)}{2n}$ это нули полинома Чебышева $T_n(y) = \cos(n \; arccos(y))$

Эти полиномы играют большую роль в теории приближений.


%$\mathrm{ln}(x) = 10$



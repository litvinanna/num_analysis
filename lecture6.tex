\section{Метод наименьших квадратов (2)}

В лекции \ref{lecture5} было показано, что реализация МНК сводится к решению системы \textbf{нормальных} уравнений 
\begin{equation} \label{eq:6.1}
	Bx = a, где B = A^TA, a = A^Tb
\end{equation}
и $A=M_{m \times n}$  -- матрица плана. решение системы \ref{eq:6.1} называется \textbf{квазирешением} переопределенной и не имеющей решений (при $m\gg n$) системы уравнений 
\begin{equation} \label{eq:6.2}
	Ax = b
\end{equation}
Рассмотрим методы поиска квазирешений, то есть рещений системы \ref{eq:6.1}. 

В пакетах прикладных программ содержится большое количество различных методов решений систем вида \ref{eq:6.1}. Ниже будут приведены некоторые из этих методов, чаще всего используемые в контексте МНК. При этом мы ограничимся методами дающими точное значение квазирешения. В соответствии с этим, методы последовательных приближений (итерационные) рассматриваться не будут.

Предполагается, что ранг матрицы $B$ равен $n$
\begin{equation} \label{eq:6.3}
	rank B = n
\end{equation}
Следовательно
\begin{equation} \label{eq:6.4}
	det B \neq 0
\end{equation}
и следовательно решение $x$ сущетсвует и единственно.

Все описанные ниже методы решения системы \ref{eq:6.1} основаны на представлении матрицы $B$ в виде
\begin{equation} \label{eq:6.5}
	B = B_1 B_2 \text{ или } B = B_1 B_2 B_3
\end{equation}
где матрицы $B_i$ \textbf{легко обращаются}.
Так как
\begin{equation} \label{eq:6.6}
	(B_1B_2)^{-1} = B_2^{-1} B_1^{-1}, (B_1B_2B_3)^{-1} = B_3^{-1}B_2^{-1} B_1^{-1}
\end{equation}
то решение системы \ref{eq:6.1} имеет вид
\begin{equation} \label{eq:6.7}
	(B_1B_2)^{-1} = B_2^{-1} B_1^{-1}, (B_1B_2B_3)^{-1} = B_3^{-1}B_2^{-1} B_1^{-1}
\end{equation}
то решение системы \ref{eq:6.1} имеет вид
\begin{equation}
	x = B^{-1} a = B_2^{-1} B_1^{-1} a \text{ или } x = B_3^{-1}B_2^{-1} B_1^{-1}
\end{equation}

Легко обращаются следующие типы квадратных матриц $M_{n \times n}$. Это верхние и нижние треугольные матрицы и ортогональные матрицы.

\textbf{Верхнетреугольные матрицы} имеют вид

\begin{equation} \label{eq:6.8}
	L = \begin{pmatrix}
		e_{11} & e_{12} & \dots &e_{1(n-1)}&e_{1n} \\
		0 & e_{22} & \dots &e_{2(n-1)}&e_{2n} \\
		%		0 & 0 & \dots &e_{3(n-1)}&e_{3n} \\
		\vdots & \vdots & \ddots &\vdots &  \vdots\\
		0 & 0 & \dots & e_{(n-1)(n-1)} &e_{(n-1)n} \\
		0 & 0 & \dots & 0 &e_{nn} \\
	\end{pmatrix}
\end{equation}
и соответственно \textbf{нижнетреугольные} матрицы вида 

\begin{equation} \label{eq:6.9}
	L = \begin{pmatrix}
		e_{11}	&		&		&	&        \\
		&e_{22}	&   		& \text{\huge0} &\\
		&		&e_{33} &	&            \\
		&\dots & & \ddots &          \\
		& 		&   		&   & e_{nn} 
	\end{pmatrix}
\end{equation}
где заштрихованная область содердит ненулевые элементы. Уравнения $Lx = y$ легко решаются, а решение $x = L^{-1}y$ задает обратную матрицу $L^{-1}$.


Матрица $P \in M_{n \times n}$ называется \textbf{ортогональной}, если
\begin{equation} \label{eq:6.10}
	(Px, Py) = (x, y), \forall x, y \in \mathbb{R}^n = M_{n \times 1}
\end{equation}
откуда сразу следует, что
\begin{equation} \label{eq:6.11}
	P^{-1} = P^T .
\end{equation}

Произвольные матрицы $B, B'$ называются \textbf{подобными}, если существуют \textbf{обратимые} (имеющие обратную) матрицы $Q_1, Q_2$ такие что

